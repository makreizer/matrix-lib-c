# Лабораторная работа №II.2. Разработка библиотеки для операций над матрицами

## Оглавление

- [Вступление](#описание-проекта)
	- [Цель проекта](#цель-работы)
	- [Задачи проекта](#основные-задачи)
	- [Структура проекта](#структура-проекта)
- [Реализация](#реализация)
	- [Особенности реализации](#особенности-реализации)
- [Список доступных функций](#функции-реализованные-в-библиотеке)
- [Сборка и запуск](#сборка-и-запуск-проекта)
- [Тестирование](#тестирование)
- [Вывод](#вывод)


## Описание проекта

Данный проект представляет собой библиотеку для работы с матрицами, реализующую базовые и расширенные операции: создание, освобождение, транспонирование, нахождение минора и определителя, арифметические операции и вывод. Библиотека построена с использованием структуры `Matrix` для удобного хранения и обработки данных и ошибок.

### Цель работы:

Освоить методы реализации операций над матрицами в языке C, включая динамическое выделение памяти, работу с файлами, обработку ошибок и реализацию функциональных интерфейсов.


### Основные задачи:
1. Реализация базовых операций над матрицами, включая создание, освобождение, копирование и вывод.
2. Поддержка арифметических операций: сумма, разность, умножение.
3. Поддержка линейной алгебры: транспонирование, определитель.
4. Подключение модулей вывода в консоль и файл.
5. Автоматизированная сборка проекта и тестирование.


### Структура проекта
```
/matrix_lib_c
│── src/
│   │── matrix/
│   │   │── Matrix.c
│   │   │── Matrix.h
│   │── output/
│   │   │── Output.c
│   │   │── Output.h
│   │── main.c
│── tests/
│   │── tests_matrix.c
│   │── tests_runner.c
│── include/
│   │── config.h
│── data/
│   │── input/
│   │── output/
│── Makefile
│── README.md
```

**Описание файлов и дирректорий:**
- **Matrix.h/Matrix.c** — основная реализация структур и функций работы с матрицами.
- **Output.h/Output.c** — функции вывода матрицы в консоль и файл.
- **main.c** — демонстрационная программа.
- **tests** — модуль тестирования библиотеки.
- **tests_matrix.c** — тестирует логику работы с матрицами.
- **tests_runner.c** — управляет запуском всех тестов и выводом результатов.
- **config.h** — основные настройки программы.
- **data/output** - содержит выходные данные (если пользователь выполнял запись в файл).
- **data/input** - содержит входные данные формата:
```math
rows\_count \;\;\; cols\_count
```
```math
n_{1,1} \; n_{1,2} \; ... \; n_{1,j}
```
```math
n_{2,1} \; n_{2,2} \; ... \; n_{2,j}
```
```math
...
```
```math
n_{i,1} \; n_{i,2} \; ... \; n_{i,j}
```
- **Makefile** — сборка и тестирование проекта.
- **README.md** — описание проекта.

## Реализация

### Особенности реализации:

- Использование структуры `Matrix`, содержащей количество строк, столбцов и двумерный массив данных.
- Используются типы `MATRIX_TYPE` из `config.h` для гибкой настройки типов данных.


## Функции, реализованные в библиотеке

### Функции для операций над матрицами
Функция | Описание
--- | ---
`void destroy_matrix(Matrix* matrix)` | Освобождает память, занятую матрицей.                                   
`Matrix create_matrix(size_t rows, size_t cols)` | Создает матрицу с указанным количеством строк и столбцов.          
`void print_matrix(const Matrix* matrix)` | Выводит матрицу на экран.                                           
`Matrix load_matrix_from_file(const char* filename)` | Загружает матрицу из файла.                                        
`int write_matrix_to_file(const Matrix* matrix, const char* filename)` | Записывает матрицу в файл.                                
`MATRIX_TYPE determinant(const Matrix* matrix)` | Вычисляет определитель матрицы.                           
`Matrix transpose_matrix(const Matrix* matrix)` | Возвращает транспонированную матрицу.                     
`int matrix_multiply(const Matrix* A, const Matrix* B, Matrix* result)` | Умножает матрицы A и B, результат сохраняет в `result`.  
`int matrix_subtract(const Matrix* A, const Matrix* B, Matrix* result)` | Вычитает матрицу B из A, результат сохраняет в `result`.  
`int matrix_add(const Matrix* A, const Matrix* B, Matrix* result)` | Складывает матрицы A и B, результат сохраняет в `result`.         

### Функции для вывода матриц
Функция | Описание
--- | ---
| `void output_print_matrix(int rows, int cols, const double* data)`       | Выводит матрицу на экран. Размеры матрицы задаются `rows` и `cols`, данные передаются массивом `data`. |
| `int output_write_matrix_to_file(int rows, int cols, const double* data, const char* filename)` | Записывает матрицу в файл. Размеры матрицы задаются `rows` и `cols`, данные передаются массивом `data`. Имя файла задается `filename`. Возвращает статус выполнения. |
| `double* output_load_matrix_from_file(int* rows, int* cols, const char* filename)` | Загружает матрицу из файла. Размеры матрицы возвращаются через указатели `rows` и `cols`, имя файла задается `filename`. Возвращает указатель на массив данных. |

### Тесты
| Тестовые функции (tests_matrix.c)                     | Описание                                                                 |
|--------------------------------------|--------------------------------------------------------------------------|
| `test_matrix_creation()`             | Проверяет создание матрицы: корректность выделения памяти, обработку недопустимых размеров. |
| `test_matrix_addition()`             | Проверяет сложение матриц: корректность вычислений и обработку несовместимых размеров. |
| `test_matrix_multiplication()`       | Проверяет умножение матриц: корректность вычислений и обработку несовместимых размеров. |
| `test_matrix_transpose()`            | Проверяет транспонирование матрицы: корректность результата и размеров. |
| `test_null_safety()`                 | Проверяет обработку NULL-указателей в операциях с матрицами. |
| `register_matrix_tests()`            | Регистрирует все тесты матриц в тестовом наборе (suite) для CUnit. |

| Тестовые функции (tests_runner.c)                   | Описание                                                                 |
|--------------------------------------|--------------------------------------------------------------------------|
| `main()`                             | Точка входа для запуска тестов: инициализирует реестр тестов, регистрирует тестовые наборы и запускает тестирование. |
| `register_matrix_tests()`            | Функция из `tests_matrix.c`, регистрирующая тесты матриц. |
| `CU_initialize_registry()`           | Инициализирует реестр тестов CUnit. |
| `CU_add_suite()`                     | Добавляет тестовый набор (suite) в реестр. |
| `CU_basic_set_mode()`                | Устанавливает режим вывода результатов тестов (например, `CU_BRM_VERBOSE`). |
| `CU_basic_run_tests()`               | Запускает все зарегистрированные тесты. |
| `CU_cleanup_registry()`              | Очищает реестр тестов и освобождает ресурсы. |
| `CU_get_error()`                     | Возвращает код ошибки CUnit (если есть). |


## Сборка и запуск проекта

**Сборка проекта:**
```sh
make
```

**Удаление промежуточных файлов:**
```sh
make clean
```

**Пересборка проекта:**
```sh
make rebuild
```

**Проверка форматирования:**
```sh
make check-format
```

**Применение форматирование:**
```sh
make format
```

**Запуск программы:**
```sh
./bin/MatrixLib
```

## Тестирование

**Запуск тестов на примере main.c**
```sh
make test
```

## Вывод
В результате работы была разработана библиотека для работы с матрицами, включающая создание, арифметические и алгебраические операции, вывод и обработку ошибок. Библиотека легко расширяема и сопровождается удобным интерфейсом и системой обработки ошибок.
